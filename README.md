# Metro Calculator - Android App

A beautiful calculator app for Android with a Metro UI design, built with Svelte and Capacitor. Features both basic and scientific calculator modes that automatically switch based on device orientation.

## Features

- ðŸ§® **Basic Calculator** (Portrait mode) - Standard arithmetic operations
- ðŸ”¬ **Scientific Calculator** (Landscape mode) - Advanced mathematical functions
- ðŸ“± **Native Android app** experience
- ðŸŽ¨ **Metro UI design** language with dark theme
- ðŸ”„ **Automatic orientation detection** - Switches between basic and scientific modes
- âœ¨ **Smooth animations** - Flip-in page animation on app launch
- ðŸ“Š **Custom status bar** - Fullscreen mode with custom UI
- ðŸ’¾ **Memory functions** - MC, MR, M+ for memory operations
- ðŸ“ **Angle modes** - Degrees, Radians, and Gradians support

## Prerequisites

Before you begin, ensure you have the following installed:

- **Node.js** (v18 or higher)
- **pnpm** (package manager)
- **Android Studio** (for Android development)
- **Java Development Kit (JDK)** (version 17 or higher)
- **Android SDK** (API level 33 or higher)

## Setup

### 1. Install Dependencies

```bash
pnpm install
```

### 2. Build the Web App

```bash
pnpm run build
```

### 3. Sync with Android

```bash
pnpm run android:sync
```

This will create the Android project in the `android/` directory if it doesn't exist.

### 4. Open in Android Studio

```bash
pnpm run android:open
```

Or manually open the `android/` folder in Android Studio.

## Development

### Run Web Development Server

```bash
pnpm run dev
```

This starts a development server at `http://localhost:7773`.

### Build and Sync Android

```bash
pnpm run android:build
```

This builds the web app and syncs it with the Android project.

### Build APK

```bash
pnpm run android:apk
```

This builds the web app, syncs with Android, and generates a debug APK at `android/app/build/outputs/apk/debug/app-debug.apk`.

### Run on Android Device/Emulator

1. Open the project in Android Studio
2. Connect an Android device or start an emulator
3. Click the "Run" button in Android Studio

## Project Structure

```
metro-calculator/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ CalculatorPage.svelte    # Main calculator component
â”‚   â”‚   â””â”€â”€ Statusbar.svelte          # Custom status bar
â”‚   â”œâ”€â”€ App.svelte                    # Main app component
â”‚   â”œâ”€â”€ main.js                       # Entry point
â”‚   â””â”€â”€ app.css                       # Global styles
â”œâ”€â”€ android/                          # Android project (generated by Capacitor)
â”œâ”€â”€ assets/                           # App icons and splash screens
â”œâ”€â”€ capacitor.config.ts               # Capacitor configuration
â”œâ”€â”€ vite.config.js                    # Vite build configuration
â””â”€â”€ package.json                      # Dependencies and scripts
```

## Calculator Features

### Basic Calculator (Portrait Mode)

- **Operations**: Addition (+), Subtraction (âˆ’), Multiplication (Ã—), Division (Ã·)
- **Functions**: Clear (C), Backspace, Sign toggle (Â±), Percentage (%)
- **Memory**: Memory Clear (MC), Memory Recall (MR), Memory Add (M+)
- **Input**: Decimal point support

### Scientific Calculator (Landscape Mode)

- **Trigonometric Functions**: sin, cos, tan (with Deg/Rad/Grad modes)
- **Logarithmic Functions**: ln, log, 10Ë£
- **Power Functions**: xÂ², xÊ¸, âˆš (square root)
- **Special Functions**: Ï€ (pi), n! (factorial)
- **All basic calculator features**

## Configuration

### Capacitor Config

The main configuration is in `capacitor.config.ts`:

- **appId**: `com.metrocalculator.app`
- **appName**: `Metro Calculator`
- **webDir**: `dist`

### Display Features

- **Auto-scaling font**: Font size automatically adjusts from 6rem to 2rem based on expression length
- **Horizontal scrolling**: When font reaches minimum size, horizontal scrolling is enabled
- **Smart scrolling**: Auto-scrolls to show new input, but allows manual scrolling to view previous content

## Building for Production

### 1. Build the Web App

```bash
pnpm run build
```

### 2. Sync with Android

```bash
pnpm run android:sync
```

### 3. Build APK/AAB in Android Studio

1. Open the project in Android Studio
2. Go to **Build > Generate Signed Bundle / APK**
3. Follow the wizard to create a signed release build

The debug APK will be available at:
```
android/app/build/outputs/apk/debug/app-debug.apk
```

## Important Notes

### Fullscreen Mode & Custom Status Bar

The app runs in fullscreen mode with a custom status bar:
- System status bar is hidden
- Custom status bar component shows time
- Content area has proper padding to account for the custom status bar
- Configured in `src/main.js` using Capacitor's StatusBar plugin

### Orientation Handling

- The calculator automatically detects device orientation
- Portrait mode shows basic calculator (4 columns, 6 rows)
- Landscape mode shows scientific calculator (8 columns, 5 rows)
- Display area height: 35% (portrait) / 8rem (landscape)
- Button grid height: 65% (portrait) / calc(100vh - 8rem) (landscape)

### Expression Evaluation

- Expressions are built as strings (e.g., "5+3Ã—2")
- Evaluation happens when the equals (=) button is pressed
- Supports standard operator precedence
- Scientific functions evaluate immediately and update the expression

## Troubleshooting

### Build Errors

- **"Module not found"**: Run `pnpm install` again
- **"Capacitor not found"**: Make sure Capacitor is installed: `pnpm install @capacitor/cli @capacitor/core @capacitor/android`

### Android Studio Issues

- **Gradle sync fails**: Update Android Studio and Gradle
- **SDK not found**: Install required SDK versions in Android Studio's SDK Manager
- **Package name mismatch**: Make sure `capacitor.config.ts`, `build.gradle`, and `strings.xml` all use `com.metrocalculator.app`

### Display Issues

- **Font not scaling**: Check browser console for errors in `adjustFontSize` function
- **Buttons cut off**: Ensure viewport height calculations are correct in CSS
- **Expression not showing**: Check that `displayText` reactive variable is working

## Available Scripts

- `pnpm run dev` - Start development server on port 7773
- `pnpm run build` - Build production bundle
- `pnpm run preview` - Preview production build
- `pnpm run android:sync` - Sync web assets with Android project
- `pnpm run android:open` - Open Android project in Android Studio
- `pnpm run android:build` - Build and sync with Android
- `pnpm run android:apk` - Build and generate debug APK

## License

GNU General Public License v3.0 - See LICENSE file for details.

## Credits

- Built with [Svelte](https://svelte.dev/)
- Native Android integration via [Capacitor](https://capacitorjs.com/)
- UI design inspired by Microsoft Metro/Windows Phone design language
- Icons from [Iconify](https://iconify.design/)
